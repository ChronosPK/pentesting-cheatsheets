#!/bin/bash

##################################
#                                #
#  https://github.com/ChronosPK  #
#  https://chronossec.site/s/    #
#                                #
##################################


# Choose output location for your scripts
if [[ ":$PATH:" == *":/usr/local/sbin:"* ]]; then
	out_dir="/usr/local/sbin/"
else
	out_dir=$(echo $PATH | cut -d":" -f1)
fi


# Run as root to move the binaries to a location in $PATH
if [[ $(id -u) -ne 0 ]]; then
  echo "This script must be run as root. Please use 'sudo' to run it."
  exit 1
fi


# Check if a file editor is mentioned
if [[ $1 ]]; then
	editor="$1"
else
	editor="/bin/cat"
fi


# Create the scripts to read the .md files 
dirname=$(basename $(realpath .))

if [[ $dirname == "pentesting-cheatsheets" ]]; then
	echo "Check out the new commands!"
	for file in $(find . -name "*.md" ! -name "README.md"); do
		script_name=$(echo $file | awk -F'./' '{print $2}' | cut -d'.' -f1)
		sudo echo -e "#!/bin/bash\n$editor $(/bin/realpath $file)" > $out_dir$script_name 
		sudo chmod +x $out_dir$script_name 
		echo "$script_name"
	done
else
	echo -e "You are not in the right directory. \nGo to 'pentesting-cheatsheets'"
	exit 1
fi


# Thank you!
